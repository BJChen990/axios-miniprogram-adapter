!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("axios/lib/utils"),require("axios/lib/core/settle"),require("axios/lib/helpers/buildURL"),require("axios/lib/core/createError")):"function"==typeof define&&define.amd?define(["axios/lib/utils","axios/lib/core/settle","axios/lib/helpers/buildURL","axios/lib/core/createError"],t):e["axios-miniprogram-adapter"]=t(e.utils,e.settle,e.buildURL,e.createError)}(this,function(n,f,p,h){"use strict";n=n&&n.hasOwnProperty("default")?n.default:n,f=f&&f.hasOwnProperty("default")?f.default:f,p=p&&p.hasOwnProperty("default")?p.default:p,h=h&&h.hasOwnProperty("default")?h.default:h;var m="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var b="wechat";var w=console.warn;return function(l){var s=function(){switch(!0){case"object"==typeof wx:return b="wechat",wx.request.bind(wx);case"object"==typeof swan:return b="baidu",swan.request.bind(wx);case"object"==typeof my:return b="alipay",my.httpRequest.bind(my);default:return wx.request.bind(wx)}}();return new Promise(function(u,c){var t,o=l.data,a=l.headers,d={method:l.method,url:p(l.url,l.params,l.paramsSerializer),success:function(e){var t,r,o,a,i,s,n=(r=l,o=d,a=(t=e).header||t.headers,i=t.statusCode||t.status,s="",200===i?s="OK":400===i&&(s="Bad Request"),{data:t.data,status:i,statusText:s,headers:a,config:r,request:o});f(u,c,n)},fail:function(e){!function(e,t,r){switch(b){case"wechat":-1!==e.errMsg.indexOf("request:fail abort")?t(h("Request aborted",r,"ECONNABORTED","")):-1!==e.errMsg.indexOf("timeout")?t(h("timeout of "+r.timeout+"ms exceeded",r,"ECONNABORTED","")):t(h("Network Error",r,null,""));break;case"alipay":[14,19].includes(e.error)?t(h("Request aborted",r,"ECONNABORTED","")):[13].includes(e.error)?t(h("timeout of "+r.timeout+"ms exceeded",r,"ECONNABORTED","")):t(h("Network Error",r,null,""));break;case"baidu":t(h("Network Error",r,null,""))}}(e,c,l)},complete:function(){t=void 0}};if(l.auth){var e=[l.auth.username||"",l.auth.password||""],r=e[0],i=e[1];a.Authorization="Basic "+function(e){for(var t,r,o=String(e),a=0,i=m,s="";o.charAt(0|a)||(i="=",a%1);s+=i.charAt(63&t>>8-a%1*8)){if(255<(r=o.charCodeAt(a+=.75)))throw new Error("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");t=t<<8|r}return s}(r+":"+i)}0!==l.timeout&&w('The "timeout" option is not supported by miniprogram. For more information about usage see "https://developers.weixin.qq.com/miniprogram/dev/framework/config.html#全局配置"'),n.forEach(a,function(e,t){var r=t.toLowerCase();if(void 0===o&&"content-type"===r||"referer"===r)delete a[t];else if("string"==typeof o&&"content-type"===r&&"application/x-www-form-urlencoded"===e)try{o=JSON.parse(o)}catch(e){}}),d.header=a,l.responseType&&(d.responseType=l.responseType),l.cancelToken&&l.cancelToken.promise.then(function(e){t&&(t.abort(),c(e),t=void 0)}),void 0!==o&&(d.data=o),t=s(d)})}});
